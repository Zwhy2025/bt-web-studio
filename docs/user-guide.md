# BT Web Studio 使用指南

BT Web Studio 是一款专为 BehaviorTree.CPP 设计的在线可视化编辑器和调试工具。本指南将帮助您快速上手并充分利用其功能。

## 目录

- [快速开始](#快速开始)
- [核心功能](#核心功能)
  - [可视化编辑](#可视化编辑)
  - [实时调试](#实时调试)
  - [事件流与时间轴回放](#事件流与时间轴回放)
  - [实时监控与黑板管理](#实时监控与黑板管理)
  - [XML 导入/导出](#xml-导入导出)
- [工作模式](#工作模式)
  - [编排模式](#编排模式)
  - [调试模式](#调试模式)
  - [回放模式](#回放模式)
- [界面布局](#界面布局)
- [快捷键](#快捷键)

## 快速开始

1. **启动应用**：
   ```bash
   ./tools/run.sh
   ```
   
2. **访问应用**：
   在浏览器中打开 `http://localhost:5173`

3. **创建新行为树**：
   - 点击左上角的 "+" 按钮创建新标签页
   - 从左侧节点库中拖拽节点到画布上
   - 连接节点形成行为树结构

## 核心功能

### 可视化编辑

#### 节点库管理
- 提供 BehaviorTree.CPP 内置的标准节点类型（Action, Condition, Control, Decorator 等）
- 支持用户自定义节点

#### 拖拽式操作
- 从节点库中拖拽节点到画布上
- 通过拖拽连接节点，形成父子关系

#### 节点连接与配置
- 在属性面板中配置节点的详细参数
- 编辑器强制执行行为树的结构规则

#### 树形结构约束
- 控制节点可以有多个子节点
- 装饰器和动作节点只能有一个父节点和一个子节点

### 实时调试

#### 单步执行与断点
- 在节点上右键选择"添加断点"设置断点
- 使用调试工具栏的控制按钮进行单步执行

#### 节点状态实时更新
- 实时显示节点状态：运行、成功、失败等

#### 调试面板
- 显示当前节点、黑板变量及相关数据

### 事件流与时间轴回放

#### 事件流记录与控制
- 记录行为树执行的每个节点状态变化
- 支持筛选、搜索事件

#### 时间轴组件
- 提供回放控制：播放、暂停、快进、跳过等
- 支持缩放、拖拽滑杆查看特定时间段内的事件

### 实时监控与黑板管理

#### 节点状态监控
- 实时节点高亮显示，展示节点状态的变化

#### 黑板变量监控与修改
- 实时展示和编辑黑板变量
- 支持在调试过程中直接修改黑板值

### XML 导入/导出

#### XML 导入与解析
- 支持将 BehaviorTree.CPP 的 XML 文件导入工具
- 自动解析并可视化显示行为树结构

#### XML 导出与生成
- 支持将编辑的行为树导出为 XML 格式
- 确保与 BehaviorTree.CPP 的兼容

## 工作模式

BT Web Studio 提供三种工作模式，可通过顶部工具栏的模式选择器切换。

### 编排模式

编排模式是默认模式，用于创建和编辑行为树。

**主要功能**：
- 节点拖拽和连接
- 属性编辑
- 自动布局
- 撤销/重做操作

**工具栏**：
- 选择工具：选择和移动节点
- 连接工具：创建节点连接
- 自动布局：整理节点布局

### 调试模式

调试模式用于与运行中的 BehaviorTree.CPP 应用进行交互式调试。

**前提条件**：
- 确保 Python 代理正在运行
- BehaviorTree.CPP 应用已启动并连接到代理

**主要功能**：
- 断点管理
- 单步执行控制
- 实时状态监控
- 黑板变量查看和修改

**调试工具栏**：
- 开始执行
- 暂停执行
- 停止执行
- 单步执行
- 断点控制

### 回放模式

回放模式用于查看和分析之前记录的行为树执行事件。

**主要功能**：
- 事件流时间轴
- 节点状态回放
- 事件筛选和搜索
- 执行速度控制

**时间轴控制**：
- 播放/暂停
- 快进/快退
- 跳转到指定时间点
- 速度调节（0.5x, 1x, 2x, 4x）

## 界面布局

BT Web Studio 采用模块化界面设计，主要包含以下区域：

1. **顶部工具栏**：
   - 模式选择器
   - 标签页管理
   - 全局操作按钮

2. **左侧节点库面板**：
   - 标准节点类型
   - 自定义节点
   - 搜索功能

3. **中央画布区域**：
   - 行为树可视化展示
   - 节点编辑和连接
   - 小地图导航

4. **右侧属性面板**：
   - 节点属性编辑
   - 树属性配置
   - 模式特定面板

5. **底部状态栏**：
   - 当前模式指示
   - 连接状态
   - 操作提示

## 快捷键

### 通用快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+N | 新建标签页 |
| Ctrl+W | 关闭当前标签页 |
| Ctrl+Tab | 切换到下一个标签页 |
| Ctrl+Shift+Tab | 切换到上一个标签页 |
| Ctrl+S | 保存当前行为树 |
| Ctrl+Z | 撤销操作 |
| Ctrl+Shift+Z | 重做操作 |
| Delete | 删除选中节点或连接 |
| Ctrl+A | 全选节点 |
| Ctrl+C | 复制选中节点 |
| Ctrl+V | 粘贴节点 |
| Ctrl+D | 克隆选中节点 |

### 画布操作

| 快捷键 | 功能 |
|--------|------|
| 空格键 | 拖拽画布 |
| 鼠标滚轮 | 缩放画布 |
| Ctrl+0 | 重置画布缩放 |
| Ctrl+1 | 适应画布大小 |
| Ctrl+L | 自动布局 |

### 调试模式

| 快捷键 | 功能 |
|--------|------|
| F5 | 开始执行 |
| F6 | 暂停执行 |
| F7 | 单步执行 |
| F8 | 停止执行 |
| F9 | 切换断点 |

### 搜索和过滤

| 快捷键 | 功能 |
|--------|------|
| Ctrl+F | 在节点库中搜索 |
| Ctrl+Shift+F | 在事件流中搜索 |

## 故障排除

### 连接问题

如果无法连接到调试后端：
1. 确保 Python 代理正在运行
2. 检查代理地址配置是否正确
3. 验证 BehaviorTree.CPP 应用是否已启动

### 性能问题

如果应用运行缓慢：
1. 减少画布上的节点数量
2. 关闭不必要的面板
3. 使用自动布局优化节点排列

### 数据问题

如果导入的 XML 文件显示不正确：
1. 验证 XML 文件格式是否符合 BehaviorTree.CPP 规范
2. 检查是否有自定义节点未在节点库中定义
3. 查看控制台错误信息

## 反馈和支持

如果您遇到任何问题或有改进建议，请：
1. 在 GitHub 上提交 Issue
2. 联系开发团队
3. 查看更新日志了解最新功能